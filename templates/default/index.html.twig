{% extends 'base.html.twig' %}

{% block title %} Les sorties du moment !{% endblock %}

{% block content %}
    <div class="container-fluid table table-responsive">
        <p>Filtrer les sorties</p>
            <div class="row">
                <div class="form-group col-lg-4">
                    <label for="sel1">Site :</label>
                    <select class="form-control" id="sel1">
                        <option>Saint-Herblain</option>
                        <option>Chartres de Bretagne</option>
                        <option>Niort</option>
                        <option>La Roche sur Yon</option>
                    </select>
                </div>
                <div class="col-lg-6">
                    <div class="checkbox">
                        <label><input type="checkbox" value="">Sorties dont je suis l'organisateur/trice</label>
                    </div>
                    <div class="checkbox">
                        <label><input type="checkbox" value="">Sorties auxquelles je suis inscrit/e</label>
                    </div>
                    <div class="checkbox ">
                        <label><input type="checkbox" value="">Sorties auxquelles je ne suis pas inscrit/e</label>
                    </div>
                    <div class="checkbox ">
                        <label><input type="checkbox" value="">Sorties passées</label>
                    </div>
                </div>
                <div class="col-lg-2">
                    <button class="btn btn-lg btn-primary float-left" type="submit">Rechercher</button>
                </div>
            </div>


<br>

        <a href="{{ path('excursion_add') }}" class="btn btn-primary float-right">Ajouter une sortie</a>

        <table class="table table-striped">



            <tr class="text-center">
                <th class="">Nom</th>
                <th class="">Date</th>
                <th class="">Clôture</th>
                <th class="">inscrits / places</th>
                <th class="">Etat</th>
                <th class="">Organisateur</th>
                <th class="">Action</th>
            </tr>

            {% for excursion in excursions %}
            <tr class="text-center">
                <td class="">{{ excursion.name }}</td>
                <td class="">{{ excursion.startDate | date ('d-m-Y') }}</td>
                <td class="">{{ excursion.endDate | date ('d-m-Y')}}</td>
                <td class="">{{ excursion.registerExcursion.count }} / {{ excursion.registrationNumberMax }}</td>
                <td class="">{{ excursion.state.libelle }}</td>
                <td class="">{{ excursion.organizer.name }}</td>
                <td class="">

                    {% set registerUser = false %}
                    {% for user in excursion.RegisterExcursion %}
                        {% if user.id == app.user.id %}
                            {% set registerUser = true %}
                        {% endif %}
                    {% endfor %}

                    {% if excursion.endDate|date("d-m-Y H:i:s") < "now"|date("d-m-Y H:i:s") %}
                        {% if not registerUser %}
                            <a href="{{ path('excursion_register',{'id': excursion.id}) }}">S'inscrire -</a>
                        {% elseif registerUser %}
                            <a href="{{ path('excursion_unregister',{'id': excursion.id}) }}">Se désister -</a>
                        {% endif %}
                    {% endif %}
                    <a href="#">Afficher</a>
                </td>
            </tr>

            {% endfor %}


        </table>
    </div>


{% endblock %}